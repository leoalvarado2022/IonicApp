(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{weVG:function(n,l,e){"use strict";e.r(l);var u=e("8Y7J"),i=e("mrSG"),t=e("s7LF"),o=e("sTnX"),a=e("imvL"),r=e("aVMi"),s=e("biaL"),b=e("Gvy4");class c{constructor(n,l,e,u,t,o,a){this.formBuilder=n,this.loaderService=l,this.authService=e,this.userService=u,this.router=t,this.toastService=o,this.httpService=a,this.onSubmit=()=>i.__awaiter(this,void 0,void 0,(function*(){this.loaderService.startLoader();try{const n=Object.assign({},this.pinForm.value);if(n&&n.pin){const l=yield this.createUserConnection(n);if(l.data&&201===l.status){const n=yield this.userConnection();if(n.user&&200===n.status){const e=yield this.checkToken();if(e.data&&200===e.status){this.authService.setConnection(e.data[0]),console.log(l,"connectionPin"),console.log(n,"user"),console.log(e,"checkToken");const u=Object.assign(n.user[0],{names:n.user[0].name,password:"",role:e.data[0].rol,pin:this.pinForm.value.pin,connectionId:l.data[0].id_conexion,app:"FX10",idUsuario:l.data[0].id_usuario}),i=yield this.assignUser(u);null===i||200!==i.status?this.pinForm.get("pin").setValue(""):(this.pinForm.reset(),yield this.userService.removeUserRemember(),yield this.userService.removeUserData(),this.authService.removeToken(),this.authService.removeConnection(),this.router.navigate(["auth/login"]))}}}}this.loaderService.stopLoader()}catch(n){this.loaderService.stopLoader()}})),this.checkToken=()=>new Promise(n=>{this.authService.checkToken().subscribe(l=>{n(l)},l=>{this.httpService.errorHandler(l),n(null)})}),this.assignUser=n=>new Promise(l=>{this.userService.assignUser(n).subscribe(n=>{l(n)},n=>{this.httpService.errorHandler(n),l(null)})}),this.userConnection=()=>new Promise(n=>{this.userService.getUser().subscribe(l=>{n(l)},l=>{this.httpService.errorHandler(l),n(null)})}),this.createUserConnection=n=>new Promise(l=>{this.authService.createPinConnection(n).subscribe(n=>{l(n)},n=>{this.httpService.errorHandler(n),l(null)})})}ngOnInit(){this.pinForm=this.formBuilder.group({pin:["",[t.m.required]]})}}class d{}var h=e("FhNQ"),g=e("pMnS"),p=e("oBZk"),m=e("ZZ/e"),v=e("SVse"),C=e("iInd"),L=u.Ab({encapsulation:0,styles:[["ion-toolbar[_ngcontent-%COMP%]{--background:var(--color-login-header)}ion-header[_ngcontent-%COMP%]{--background:var(--color-login-header);background:var(--color-login-header);--color:white;color:#fff}ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]{background:var(--color-login-header)}ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-left:5%}@media (min-width:360px){ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-bottom:10px;padding-top:20px}}"]],data:{}});function f(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,1,"div",[["style","color: red"]],null,null,null,null,null)),(n()(),u.Vb(-1,null,[" El Pin es requerido "]))],null,null)}function S(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,11,"ion-header",[],null,null,null,p.nb,p.s)),u.Bb(1,49152,null,0,m.C,[u.j,u.p,u.F],null,null),(n()(),u.Cb(2,0,null,0,6,"ion-toolbar",[],null,null,null,p.Ob,p.T)),u.Bb(3,49152,null,0,m.Db,[u.j,u.p,u.F],null,null),(n()(),u.Cb(4,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,p.ab,p.f)),u.Bb(5,49152,null,0,m.m,[u.j,u.p,u.F],null,null),(n()(),u.Cb(6,0,null,0,2,"ion-back-button",[["class","white"],["text",""]],null,[[null,"click"]],(function(n,l,e){var i=!0;return"click"===l&&(i=!1!==u.Nb(n,8).onClick(e)&&i),i}),p.X,p.c)),u.Bb(7,49152,null,0,m.h,[u.j,u.p,u.F],{text:[0,"text"]},null),u.Bb(8,16384,null,0,m.i,[[2,m.jb],m.Jb],null,null),(n()(),u.Cb(9,0,null,0,2,"div",[["class","title-header"]],null,null,null,null,null)),(n()(),u.Cb(10,0,null,null,1,"h3",[["class","ion-text-left"]],null,null,null,null,null)),(n()(),u.Vb(-1,null,["PIN"])),(n()(),u.Cb(12,0,null,null,26,"ion-content",[],null,null,null,p.ib,p.n)),u.Bb(13,49152,null,0,m.v,[u.j,u.p,u.F],null,null),(n()(),u.Cb(14,0,null,0,24,"div",[["class","pd-default"]],null,null,null,null,null)),(n()(),u.Cb(15,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),u.Cb(16,0,null,null,22,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(n,l,e){var i=!0,t=n.component;return"submit"===l&&(i=!1!==u.Nb(n,18).onSubmit(e)&&i),"reset"===l&&(i=!1!==u.Nb(n,18).onReset()&&i),"ngSubmit"===l&&(i=!1!==t.onSubmit()&&i),i}),null,null)),u.Bb(17,16384,null,0,t.q,[],null,null),u.Bb(18,540672,null,0,t.e,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),u.Sb(2048,null,t.a,null,[t.e]),u.Bb(20,16384,null,0,t.k,[[4,t.a]],null,null),(n()(),u.Cb(21,0,null,null,11,"ion-item",[],null,null,null,p.ub,p.w)),u.Bb(22,49152,null,0,m.I,[u.j,u.p,u.F],null,null),(n()(),u.Cb(23,0,null,0,2,"ion-label",[["position","floating"]],null,null,null,p.vb,p.A)),u.Bb(24,49152,null,0,m.O,[u.j,u.p,u.F],{position:[0,"position"]},null),(n()(),u.Vb(-1,0,["PIN"])),(n()(),u.Cb(26,0,null,0,6,"ion-input",[["formControlName","pin"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var i=!0;return"ionBlur"===l&&(i=!1!==u.Nb(n,27)._handleBlurEvent(e.target)&&i),"ionChange"===l&&(i=!1!==u.Nb(n,27)._handleIonChange(e.target)&&i),i}),p.qb,p.v)),u.Bb(27,16384,null,0,m.Kb,[u.p],null,null),u.Sb(1024,null,t.h,(function(n){return[n]}),[m.Kb]),u.Bb(29,671744,null,0,t.d,[[3,t.a],[8,null],[8,null],[6,t.h],[2,t.p]],{name:[0,"name"]},null),u.Sb(2048,null,t.i,null,[t.d]),u.Bb(31,16384,null,0,t.j,[[4,t.i]],null,null),u.Bb(32,49152,null,0,m.H,[u.j,u.p,u.F],{type:[0,"type"]},null),(n()(),u.rb(16777216,null,null,1,null,f)),u.Bb(34,16384,null,0,v.l,[u.X,u.T],{ngIf:[0,"ngIf"]},null),(n()(),u.Cb(35,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),u.Cb(36,0,null,null,2,"ion-button",[["color","danger"],["expand","block"],["type","submit"]],null,null,null,p.Z,p.e)),u.Bb(37,49152,null,0,m.l,[u.j,u.p,u.F],{color:[0,"color"],disabled:[1,"disabled"],expand:[2,"expand"],type:[3,"type"]},null),(n()(),u.Vb(-1,0,[" Aceptar "]))],(function(n,l){var e=l.component;n(l,7,0,""),n(l,18,0,e.pinForm),n(l,24,0,"floating"),n(l,29,0,"pin"),n(l,32,0,"number"),n(l,34,0,e.pinForm.controls.pin.dirty&&e.pinForm.hasError("required","pin")),n(l,37,0,"danger",e.pinForm.invalid,"block","submit")}),(function(n,l){n(l,16,0,u.Nb(l,20).ngClassUntouched,u.Nb(l,20).ngClassTouched,u.Nb(l,20).ngClassPristine,u.Nb(l,20).ngClassDirty,u.Nb(l,20).ngClassValid,u.Nb(l,20).ngClassInvalid,u.Nb(l,20).ngClassPending),n(l,26,0,u.Nb(l,31).ngClassUntouched,u.Nb(l,31).ngClassTouched,u.Nb(l,31).ngClassPristine,u.Nb(l,31).ngClassDirty,u.Nb(l,31).ngClassValid,u.Nb(l,31).ngClassInvalid,u.Nb(l,31).ngClassPending)}))}function F(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,1,"app-pin",[],null,null,null,S,L)),u.Bb(1,114688,null,0,c,[t.c,o.a,a.a,s.a,C.n,r.a,b.a],null,null)],(function(n,l){n(l,1,0)}),null)}var P=u.yb("app-pin",c,F,{},{},[]),N=e("IheW"),k=e("ocFP"),B=e("1dSU"),y=e("xgBC"),w=e("QURO"),O=e("ElRG"),M=e("v2G1"),j=e("t8sF"),_=e("s3Gz"),I=e("ZWll"),U=e("Pn9U"),x=e("niFY"),T=e("wMzM"),V=e("AjED"),X=e("Q1xG"),q=e("PCNd");e.d(l,"PinPageModuleNgFactory",(function(){return E}));var E=u.zb(d,[],(function(n){return u.Kb([u.Lb(512,u.m,u.kb,[[8,[h.a,g.a,P]],[3,u.m],u.D]),u.Lb(4608,v.n,v.m,[u.z,[2,v.y]]),u.Lb(4608,t.o,t.o,[]),u.Lb(4608,m.c,m.c,[u.F,u.g]),u.Lb(4608,m.Ib,m.Ib,[m.c,u.m,u.w]),u.Lb(4608,m.Mb,m.Mb,[m.c,u.m,u.w]),u.Lb(4608,N.j,N.p,[v.c,u.I,N.n]),u.Lb(4608,N.q,N.q,[N.j,N.o]),u.Lb(5120,N.a,(function(n){return[n]}),[N.q]),u.Lb(4608,N.m,N.m,[]),u.Lb(6144,N.k,null,[N.m]),u.Lb(4608,N.i,N.i,[N.k]),u.Lb(6144,N.b,null,[N.i]),u.Lb(4608,N.g,N.l,[N.b,u.w]),u.Lb(4608,N.c,N.c,[N.g]),u.Lb(4608,t.c,t.c,[]),u.Lb(4608,r.a,r.a,[m.Rb]),u.Lb(4608,b.a,b.a,[C.n,k.a,r.a]),u.Lb(4608,B.a,B.a,[y.b]),u.Lb(4608,s.a,s.a,[N.c,b.a,B.a]),u.Lb(4608,w.a,w.a,[O.a,m.Lb]),u.Lb(4608,M.a,M.a,[m.b]),u.Lb(4608,j.a,j.a,[]),u.Lb(4608,_.a,_.a,[]),u.Lb(4608,I.a,I.a,[U.a,r.a,o.a]),u.Lb(4608,x.a,x.a,[a.a,N.c,B.a,b.a]),u.Lb(4608,T.a,T.a,[]),u.Lb(4608,V.a,V.a,[b.a,N.c]),u.Lb(1073742336,v.b,v.b,[]),u.Lb(1073742336,t.n,t.n,[]),u.Lb(1073742336,t.g,t.g,[]),u.Lb(1073742336,m.Fb,m.Fb,[]),u.Lb(1073742336,N.e,N.e,[]),u.Lb(1073742336,N.d,N.d,[]),u.Lb(1073742336,t.l,t.l,[]),u.Lb(1073742336,X.a,X.a,[]),u.Lb(1073742336,q.a,q.a,[]),u.Lb(1073742336,C.p,C.p,[[2,C.u],[2,C.n]]),u.Lb(1073742336,d,d,[]),u.Lb(256,N.n,"XSRF-TOKEN",[]),u.Lb(256,N.o,"X-XSRF-TOKEN",[]),u.Lb(1024,C.l,(function(){return[[{path:"",component:c}]]}),[])])}))}}]);