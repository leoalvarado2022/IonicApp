{"version":3,"sources":["./src/app/home-page/rem/rem-workers/rem-workers.page.html","./src/app/home-page/rem/rem-workers/rem-workers.module.ts","./src/app/home-page/rem/rem-workers/rem-workers.page.scss","./src/app/home-page/rem/rem-workers/rem-workers.page.ts"],"names":[],"mappings":"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","file":"rem-rem-workers-rem-workers-module-es2015.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar class=\\\"background-color-header\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button class=\\\"header-back-button\\\" text=\\\"\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>\\r\\n      <strong>Trabajadores</strong>\\r\\n    </ion-title>\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <app-notifications></app-notifications>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-refresher (ionRefresh)=\\\"reload($event)\\\" class=\\\"refresher\\\" slot=\\\"fixed\\\">\\r\\n    <ion-refresher-content\\r\\n      pullingIcon=\\\"arrow-dropdown\\\"\\r\\n      pullingText=\\\"Pull to refresh\\\"\\r\\n      refreshingSpinner=\\\"circles\\\"\\r\\n      refreshingText=\\\"Cargando...\\\">\\r\\n    </ion-refresher-content>\\r\\n  </ion-refresher>\\r\\n\\r\\n  <ng-container *ngIf=\\\"quadrille\\\">\\r\\n    <h2 class=\\\"ion-text-center\\\">\\r\\n      {{ quadrille.name }}\\r\\n      <ion-badge class=\\\"quadrille-badge\\\" color=\\\"primary\\\">{{ filteredWorkers.length }}</ion-badge>\\r\\n    </h2>\\r\\n\\r\\n    <ng-container *ngIf=\\\"filteredWorkers.length > 0\\\">\\r\\n      <ion-list lines=\\\"none\\\">\\r\\n        <ion-virtual-scroll [items]=\\\"filteredWorkers\\\">\\r\\n          <ion-item (click)=\\\"markWorker(worker)\\\" *virtualItem=\\\"let worker\\\" [ngClass]=\\\"{ 'workerSelected': selectedWorkers.includes(worker) }\\\">\\r\\n            <ion-icon name=\\\"contact\\\" slot=\\\"start\\\"></ion-icon>\\r\\n            <ion-label>\\r\\n              <h3 class=\\\"label-padding\\\">{{ worker.name }}</h3>\\r\\n              <div class=\\\"label-padding\\\">\\r\\n\\r\\n                <div class=\\\"ion-text-left\\\">\\r\\n                  {{ worker.identifier | rut }}\\r\\n                </div>\\r\\n                <div class=\\\"ion-text-right\\\">\\r\\n                  <ng-container *ngIf=\\\"worker.quadrilleToApprove > 0\\\">\\r\\n                    <ion-badge *ngIf=\\\"worker.quadrilleStatus === 'POR APROBAR' && worker.quadrille === quadrille.id\\\" color=\\\"warning\\\">\\r\\n                      Traspasando\\r\\n                    </ion-badge>\\r\\n                    <ion-badge *ngIf=\\\"worker.quadrilleStatus === 'POR APROBAR' && worker.quadrille !== quadrille.id\\\" color=\\\"warning\\\">\\r\\n                      Por Aprobar\\r\\n                    </ion-badge>\\r\\n                  </ng-container>\\r\\n                  <ng-container *ngIf=\\\"worker.quadrilleToApprove === 0\\\">\\r\\n                    <ion-badge color=\\\"danger\\\">{{ worker.quadrilleStatus | uppercase }}</ion-badge>\\r\\n                  </ng-container>\\r\\n                </div>\\r\\n              </div>\\r\\n            </ion-label>\\r\\n          </ion-item>\\r\\n        </ion-virtual-scroll>\\r\\n      </ion-list>\\r\\n    </ng-container>\\r\\n  </ng-container>\\r\\n\\r\\n</ion-content>\\r\\n\\r\\n<ion-footer>\\r\\n  <ng-container *ngIf=\\\"selectedWorkers.length > 0\\\">\\r\\n    <ion-row>\\r\\n      <ng-container *ngIf=\\\"selectedWorkers[0].quadrilleToApprove === 0\\\">\\r\\n        <ion-col>\\r\\n          <ng-container *ngIf=\\\"selectedWorkers[0].quadrilleStatus === ''\\\">\\r\\n            <ion-button (click)=\\\"selectQuadrille();\\\" color=\\\"warning\\\" expand=\\\"block\\\">\\r\\n              Traspasar {{ selectedWorkers.length }}\\r\\n            </ion-button>\\r\\n          </ng-container>\\r\\n          <ng-container *ngIf=\\\"selectedWorkers[0].quadrilleStatus === 'rechazado'\\\">\\r\\n            <ion-button (click)=\\\"acceptRejectWorkers()\\\" color=\\\"success\\\" expand=\\\"block\\\">\\r\\n              Aprobar {{ selectedWorkers.length }}\\r\\n            </ion-button>\\r\\n          </ng-container>\\r\\n        </ion-col>\\r\\n      </ng-container>\\r\\n\\r\\n      <ng-container *ngIf=\\\"selectedWorkers[0].quadrilleToApprove > 0\\\">\\r\\n        <ion-col>\\r\\n          <ion-button (click)=\\\"acceptWorkers();\\\" color=\\\"success\\\" expand=\\\"block\\\">\\r\\n            Aprobar {{ selectedWorkers.length }}\\r\\n          </ion-button>\\r\\n        </ion-col>\\r\\n        <ion-col>\\r\\n          <ion-button (click)=\\\"rejectWorkers();\\\" color=\\\"danger\\\" expand=\\\"block\\\">\\r\\n            Rechazar {{ selectedWorkers.length }}\\r\\n          </ion-button>\\r\\n        </ion-col>\\r\\n      </ng-container>\\r\\n    </ion-row>\\r\\n  </ng-container>\\r\\n</ion-footer>\\r\\n\"","import {NgModule} from '@angular/core';\r\nimport {RouterModule, Routes} from '@angular/router';\r\nimport {RemWorkersPage} from './rem-workers.page';\r\nimport {SharedModule} from '../../../shared/shared.module';\r\nimport {QuadrilleService} from '../rem-quadrille/services/quadrille/quadrille.service';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: ':id',\r\n    component: RemWorkersPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [RemWorkersPage],\r\n  providers: [\r\n    QuadrilleService\r\n  ]\r\n})\r\nexport class RemWorkersPageModule {\r\n\r\n}\r\n","export default \"ion-menu-button {\\n  --color: white;\\n}\\n\\nion-title {\\n  color: white;\\n}\\n\\n.label-padding {\\n  padding-top: 8px;\\n  font-size: 18px;\\n}\\n\\n.quadrille-badge {\\n  --padding-top: 5px;\\n  font-size: 1em;\\n}\\n\\n.workerSelected {\\n  --background: var(--ion-color-medium);\\n  --color: var(--ion-color-light);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaG9tZS1wYWdlL3JlbS9yZW0td29ya2Vycy9EOlxcbnBtXFxmeDExX21vYmlsZS9zcmNcXGFwcFxcaG9tZS1wYWdlXFxyZW1cXHJlbS13b3JrZXJzXFxyZW0td29ya2Vycy5wYWdlLnNjc3MiLCJzcmMvYXBwL2hvbWUtcGFnZS9yZW0vcmVtLXdvcmtlcnMvcmVtLXdvcmtlcnMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtBQ0NGOztBREVBO0VBQ0UsWUFBQTtBQ0NGOztBREVBO0VBQ0UsZ0JBQUE7RUFDQSxlQUFBO0FDQ0Y7O0FERUE7RUFDRSxrQkFBQTtFQUNBLGNBQUE7QUNDRjs7QURFQTtFQUNFLHFDQUFBO0VBQ0EsK0JBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXBwL2hvbWUtcGFnZS9yZW0vcmVtLXdvcmtlcnMvcmVtLXdvcmtlcnMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLW1lbnUtYnV0dG9uIHtcclxuICAtLWNvbG9yOiB3aGl0ZTtcclxufVxyXG5cclxuaW9uLXRpdGxlIHtcclxuICBjb2xvcjogd2hpdGU7XHJcbn1cclxuXHJcbi5sYWJlbC1wYWRkaW5nIHtcclxuICBwYWRkaW5nLXRvcDogOHB4O1xyXG4gIGZvbnQtc2l6ZTogMThweDtcclxufVxyXG5cclxuLnF1YWRyaWxsZS1iYWRnZSB7XHJcbiAgLS1wYWRkaW5nLXRvcDogNXB4O1xyXG4gIGZvbnQtc2l6ZTogMWVtO1xyXG59XHJcblxyXG4ud29ya2VyU2VsZWN0ZWQge1xyXG4gIC0tYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLW1lZGl1bSk7XHJcbiAgLS1jb2xvcjogdmFyKC0taW9uLWNvbG9yLWxpZ2h0KTtcclxufVxyXG4iLCJpb24tbWVudS1idXR0b24ge1xuICAtLWNvbG9yOiB3aGl0ZTtcbn1cblxuaW9uLXRpdGxlIHtcbiAgY29sb3I6IHdoaXRlO1xufVxuXG4ubGFiZWwtcGFkZGluZyB7XG4gIHBhZGRpbmctdG9wOiA4cHg7XG4gIGZvbnQtc2l6ZTogMThweDtcbn1cblxuLnF1YWRyaWxsZS1iYWRnZSB7XG4gIC0tcGFkZGluZy10b3A6IDVweDtcbiAgZm9udC1zaXplOiAxZW07XG59XG5cbi53b3JrZXJTZWxlY3RlZCB7XG4gIC0tYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLW1lZGl1bSk7XG4gIC0tY29sb3I6IHZhcigtLWlvbi1jb2xvci1saWdodCk7XG59Il19 */\"","import {Component, OnDestroy, OnInit} from '@angular/core';\r\nimport {SyncService} from '../../../shared/services/sync/sync.service';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {LoaderService} from '../../../shared/services/loader/loader.service';\r\nimport {ActionSheetController} from '@ionic/angular';\r\nimport {QuadrilleService} from '../rem-quadrille/services/quadrille/quadrille.service';\r\nimport {UserService} from '../../../shared/services/user/user.service';\r\nimport {HttpService} from '../../../shared/services/http/http.service';\r\nimport {StoreService} from '../../../shared/services/store/store.service';\r\nimport {Subscription} from 'rxjs';\r\n\r\nenum WorkerStatus {\r\n  'POR APROBAR' = 'por aprobar',\r\n  'APROBADO' = 'aprobado',\r\n  'RECHAZADO' = 'rechazado',\r\n  'APRUEBA RECHAZO' = 'apruebarechazo'\r\n}\r\n\r\n@Component({\r\n  selector: 'app-rem-workers',\r\n  templateUrl: './rem-workers.page.html',\r\n  styleUrls: ['./rem-workers.page.scss'],\r\n})\r\nexport class RemWorkersPage implements OnInit, OnDestroy {\r\n\r\n  public filteredWorkers: Array<any> = [];\r\n  public quadrille: any;\r\n  public selectedWorkers: Array<any> = [];\r\n  private workers: Array<any> = [];\r\n  private quadrilles: Array<any> = [];\r\n  private buttons: Array<any> = [];\r\n  private userData = null;\r\n\r\n  private store$: Subscription;\r\n\r\n  constructor(\r\n    private syncService: SyncService,\r\n    private route: ActivatedRoute,\r\n    private loaderService: LoaderService,\r\n    private actionSheetController: ActionSheetController,\r\n    private quadrilleService: QuadrilleService,\r\n    private userService: UserService,\r\n    private httpService: HttpService,\r\n    private storeService: StoreService\r\n  ) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n    const id = this.route.snapshot.paramMap.get('id');\r\n\r\n    this.store$ = this.storeService.stateChanged.subscribe(data => {\r\n      this.userData = this.storeService.getUser();\r\n      this.loadWorkers(id);\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.store$.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * reload\r\n   * @param event\r\n   */\r\n  public reload = (event) => {\r\n    const id = this.route.snapshot.paramMap.get('id');\r\n    this.loadWorkers(id);\r\n    event.target.complete();\r\n  }\r\n\r\n  /**\r\n   * markWorker\r\n   * @param worker\r\n   */\r\n  public markWorker = (worker: any) => {\r\n    if (this.selectedWorkers.includes(worker)) {\r\n      const index = this.selectedWorkers.indexOf(worker);\r\n      this.selectedWorkers.splice(index, 1);\r\n    } else {\r\n      if (this.selectedWorkers.length > 0) {\r\n        this.selectedWorkers = this.selectedWorkers.filter(item => item.quadrilleStatus === worker.quadrilleStatus);\r\n      }\r\n\r\n      this.selectedWorkers.push(worker);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * selectQuadrille\r\n   */\r\n  public selectQuadrille = async () => {\r\n    const actionSheet = await this.actionSheetController.create({\r\n      header: 'Cuadrillas',\r\n      buttons: [\r\n        ...this.buttons,\r\n        {\r\n          text: 'Cancelar',\r\n          icon: 'close',\r\n          role: 'cancel',\r\n          handler: () => {\r\n            this.selectedWorkers = [];\r\n          }\r\n        }]\r\n    });\r\n\r\n    await actionSheet.present();\r\n  }\r\n\r\n  /**\r\n   * acceptWorkers\r\n   */\r\n  public acceptWorkers = () => {\r\n    this.transferWorkers(this.quadrille.id, WorkerStatus.APROBADO);\r\n  }\r\n\r\n  /**\r\n   * rejectWorkers\r\n   */\r\n  public rejectWorkers = () => {\r\n    this.transferWorkers(this.quadrille.id, WorkerStatus.RECHAZADO);\r\n  }\r\n\r\n  /**\r\n   * acceptRejectWorkers\r\n   */\r\n  public acceptRejectWorkers = () => {\r\n    this.transferWorkers(this.quadrille.id, WorkerStatus['APRUEBA RECHAZO']);\r\n  }\r\n\r\n  /**\r\n   * loadWorkers\r\n   */\r\n  private loadWorkers = (id: string) => {\r\n    this.loaderService.startLoader();\r\n    const quadrilles = this.storeService.getQuadrilles();\r\n    const allWorkers = this.storeService.getWorkers();\r\n\r\n    if (quadrilles && allWorkers) {\r\n      this.quadrilles = [...quadrilles];\r\n      this.quadrille = quadrilles.find(item => item.id === +id);\r\n      const workers = allWorkers.filter(item => item.quadrille === this.quadrille.id || item.quadrilleToApprove === this.quadrille.id);\r\n      this.workers = [...workers];\r\n      this.filteredWorkers = [...workers];\r\n\r\n      this.buildButtons();\r\n    }\r\n\r\n    this.loaderService.stopLoader();\r\n  }\r\n\r\n  /**\r\n   * buildButtons\r\n   */\r\n  private buildButtons = () => {\r\n    this.buttons = this.quadrilles\r\n      .filter(item => item !== this.quadrille)\r\n      .map(item => ({\r\n        text: item.name,\r\n        icon: 'people',\r\n        handler: () => {\r\n          this.transferWorkers(item.id, WorkerStatus['POR APROBAR']);\r\n        }\r\n      }));\r\n  }\r\n\r\n  /**\r\n   * transferWorkers\r\n   */\r\n  private transferWorkers = (quadrille: number, status: string) => {\r\n    const data = {\r\n      quadrille,\r\n      workers: this.selectedWorkers,\r\n      status\r\n    };\r\n\r\n    this.loaderService.startLoader();\r\n\r\n    this.quadrilleService.transferWorkers(data).subscribe(success => {\r\n      this.loaderService.stopLoader();\r\n      this.selectedWorkers = [];\r\n      this.reSync();\r\n    }, error => {\r\n      this.loaderService.stopLoader();\r\n      this.httpService.errorHandler(error);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * reSync\r\n   */\r\n  private reSync = () => {\r\n    this.loaderService.startLoader();\r\n    const id = this.route.snapshot.paramMap.get('id');\r\n    this.syncData();\r\n    // this.loadWorkers(id);\r\n    this.loaderService.stopLoader();\r\n  }\r\n\r\n  /**\r\n   * syncData\r\n   * @param username\r\n   */\r\n  private syncData = () => {\r\n    const username = this.userData.username;\r\n    const activeConnection = this.storeService.getActiveConnection();\r\n\r\n    this.syncService.syncData(username, activeConnection.superuser ? 1 : 0).subscribe((success: any) => {\r\n      this.storeService.setSyncedData(success.data);\r\n    }, async error => {\r\n      this.httpService.errorHandler(error);\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"webpack:///"}