function _classCallCheck(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,l){for(var e=0;e<l.length;e++){var u=l[e];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}function _createClass(n,l,e){return l&&_defineProperties(n.prototype,l),e&&_defineProperties(n,e),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{weVG:function(n,l,e){"use strict";e.r(l);var u=e("8Y7J"),t=e("mrSG"),i=e("s7LF"),r=e("sTnX"),a=e("imvL"),o=e("aVMi"),s=e("biaL"),b=e("Gvy4"),c=function(){function n(l,e,u,i,r,a,o){var s=this;_classCallCheck(this,n),this.formBuilder=l,this.loaderService=e,this.authService=u,this.userService=i,this.router=r,this.toastService=a,this.httpService=o,this.onSubmit=function(){return t.__awaiter(s,void 0,void 0,regeneratorRuntime.mark((function n(){var l,e,u,t,i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.loaderService.startLoader(),n.prev=1,!(l=Object.assign({},this.pinForm.value))||!l.pin){n.next=33;break}return n.next=6,this.createUserConnection(l);case 6:if(!(e=n.sent).data||201!==e.status){n.next=33;break}return n.next=10,this.userConnection();case 10:if(!(u=n.sent).user||200!==u.status){n.next=33;break}return n.next=14,this.checkToken();case 14:if(!(t=n.sent).data||200!==t.status){n.next=33;break}return this.authService.setConnection(t.data[0]),console.log(e,"connectionPin"),console.log(u,"user"),console.log(t,"checkToken"),i=Object.assign(u.user[0],{names:u.user[0].name,password:"",role:t.data[0].rol,pin:this.pinForm.value.pin,connectionId:e.data[0].id_conexion,app:"FX10",idUsuario:e.data[0].id_usuario}),n.next=20,this.assignUser(i);case 20:if(null!==(r=n.sent)&&200===r.status){n.next=25;break}this.pinForm.get("pin").setValue(""),n.next=33;break;case 25:return this.pinForm.reset(),n.next=28,this.userService.removeUserRemember();case 28:return n.next=30,this.userService.removeUserData();case 30:this.authService.removeToken(),this.authService.removeConnection(),this.router.navigate(["auth/login"]);case 33:this.loaderService.stopLoader(),n.next=39;break;case 36:n.prev=36,n.t0=n.catch(1),this.loaderService.stopLoader();case 39:case"end":return n.stop()}}),n,this,[[1,36]])})))},this.checkToken=function(){return new Promise((function(n){s.authService.checkToken().subscribe((function(l){n(l)}),(function(l){s.httpService.errorHandler(l),n(null)}))}))},this.assignUser=function(n){return new Promise((function(l){s.userService.assignUser(n).subscribe((function(n){l(n)}),(function(n){s.httpService.errorHandler(n),l(null)}))}))},this.userConnection=function(){return new Promise((function(n){s.userService.getUser().subscribe((function(l){n(l)}),(function(l){s.httpService.errorHandler(l),n(null)}))}))},this.createUserConnection=function(n){return new Promise((function(l){s.authService.createPinConnection(n).subscribe((function(n){l(n)}),(function(n){s.httpService.errorHandler(n),l(null)}))}))}}return _createClass(n,[{key:"ngOnInit",value:function(){this.pinForm=this.formBuilder.group({pin:["",[i.m.required]]})}}]),n}(),d=function n(){_classCallCheck(this,n)},h=e("FhNQ"),p=e("pMnS"),g=e("oBZk"),f=e("ZZ/e"),v=e("SVse"),m=e("iInd"),C=u.Ab({encapsulation:0,styles:[["ion-toolbar[_ngcontent-%COMP%]{--background:var(--color-login-header)}ion-header[_ngcontent-%COMP%]{--background:var(--color-login-header);background:var(--color-login-header);--color:white;color:#fff}ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]{background:var(--color-login-header)}ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-left:5%}@media (min-width:360px){ion-header[_ngcontent-%COMP%]   .title-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding-bottom:10px;padding-top:20px}}"]],data:{}});function L(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,1,"div",[["style","color: red"]],null,null,null,null,null)),(n()(),u.Vb(-1,null,[" El Pin es requerido "]))],null,null)}function k(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,11,"ion-header",[],null,null,null,g.nb,g.s)),u.Bb(1,49152,null,0,f.C,[u.j,u.p,u.F],null,null),(n()(),u.Cb(2,0,null,0,6,"ion-toolbar",[],null,null,null,g.Ob,g.T)),u.Bb(3,49152,null,0,f.Db,[u.j,u.p,u.F],null,null),(n()(),u.Cb(4,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,g.ab,g.f)),u.Bb(5,49152,null,0,f.m,[u.j,u.p,u.F],null,null),(n()(),u.Cb(6,0,null,0,2,"ion-back-button",[["class","white"],["text",""]],null,[[null,"click"]],(function(n,l,e){var t=!0;return"click"===l&&(t=!1!==u.Nb(n,8).onClick(e)&&t),t}),g.X,g.c)),u.Bb(7,49152,null,0,f.h,[u.j,u.p,u.F],{text:[0,"text"]},null),u.Bb(8,16384,null,0,f.i,[[2,f.jb],f.Jb],null,null),(n()(),u.Cb(9,0,null,0,2,"div",[["class","title-header"]],null,null,null,null,null)),(n()(),u.Cb(10,0,null,null,1,"h3",[["class","ion-text-left"]],null,null,null,null,null)),(n()(),u.Vb(-1,null,["PIN"])),(n()(),u.Cb(12,0,null,null,26,"ion-content",[],null,null,null,g.ib,g.n)),u.Bb(13,49152,null,0,f.v,[u.j,u.p,u.F],null,null),(n()(),u.Cb(14,0,null,0,24,"div",[["class","pd-default"]],null,null,null,null,null)),(n()(),u.Cb(15,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),u.Cb(16,0,null,null,22,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(n,l,e){var t=!0,i=n.component;return"submit"===l&&(t=!1!==u.Nb(n,18).onSubmit(e)&&t),"reset"===l&&(t=!1!==u.Nb(n,18).onReset()&&t),"ngSubmit"===l&&(t=!1!==i.onSubmit()&&t),t}),null,null)),u.Bb(17,16384,null,0,i.q,[],null,null),u.Bb(18,540672,null,0,i.e,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),u.Sb(2048,null,i.a,null,[i.e]),u.Bb(20,16384,null,0,i.k,[[4,i.a]],null,null),(n()(),u.Cb(21,0,null,null,11,"ion-item",[],null,null,null,g.ub,g.w)),u.Bb(22,49152,null,0,f.I,[u.j,u.p,u.F],null,null),(n()(),u.Cb(23,0,null,0,2,"ion-label",[["position","floating"]],null,null,null,g.vb,g.A)),u.Bb(24,49152,null,0,f.O,[u.j,u.p,u.F],{position:[0,"position"]},null),(n()(),u.Vb(-1,0,["PIN"])),(n()(),u.Cb(26,0,null,0,6,"ion-input",[["formControlName","pin"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ionBlur"],[null,"ionChange"]],(function(n,l,e){var t=!0;return"ionBlur"===l&&(t=!1!==u.Nb(n,27)._handleBlurEvent(e.target)&&t),"ionChange"===l&&(t=!1!==u.Nb(n,27)._handleIonChange(e.target)&&t),t}),g.qb,g.v)),u.Bb(27,16384,null,0,f.Kb,[u.p],null,null),u.Sb(1024,null,i.h,(function(n){return[n]}),[f.Kb]),u.Bb(29,671744,null,0,i.d,[[3,i.a],[8,null],[8,null],[6,i.h],[2,i.p]],{name:[0,"name"]},null),u.Sb(2048,null,i.i,null,[i.d]),u.Bb(31,16384,null,0,i.j,[[4,i.i]],null,null),u.Bb(32,49152,null,0,f.H,[u.j,u.p,u.F],{type:[0,"type"]},null),(n()(),u.rb(16777216,null,null,1,null,L)),u.Bb(34,16384,null,0,v.l,[u.X,u.T],{ngIf:[0,"ngIf"]},null),(n()(),u.Cb(35,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),u.Cb(36,0,null,null,2,"ion-button",[["color","danger"],["expand","block"],["type","submit"]],null,null,null,g.Z,g.e)),u.Bb(37,49152,null,0,f.l,[u.j,u.p,u.F],{color:[0,"color"],disabled:[1,"disabled"],expand:[2,"expand"],type:[3,"type"]},null),(n()(),u.Vb(-1,0,[" Aceptar "]))],(function(n,l){var e=l.component;n(l,7,0,""),n(l,18,0,e.pinForm),n(l,24,0,"floating"),n(l,29,0,"pin"),n(l,32,0,"number"),n(l,34,0,e.pinForm.controls.pin.dirty&&e.pinForm.hasError("required","pin")),n(l,37,0,"danger",e.pinForm.invalid,"block","submit")}),(function(n,l){n(l,16,0,u.Nb(l,20).ngClassUntouched,u.Nb(l,20).ngClassTouched,u.Nb(l,20).ngClassPristine,u.Nb(l,20).ngClassDirty,u.Nb(l,20).ngClassValid,u.Nb(l,20).ngClassInvalid,u.Nb(l,20).ngClassPending),n(l,26,0,u.Nb(l,31).ngClassUntouched,u.Nb(l,31).ngClassTouched,u.Nb(l,31).ngClassPristine,u.Nb(l,31).ngClassDirty,u.Nb(l,31).ngClassValid,u.Nb(l,31).ngClassInvalid,u.Nb(l,31).ngClassPending)}))}var S=u.yb("app-pin",c,(function(n){return u.Xb(0,[(n()(),u.Cb(0,0,null,null,1,"app-pin",[],null,null,null,k,C)),u.Bb(1,114688,null,0,c,[i.c,r.a,a.a,s.a,m.n,o.a,b.a],null,null)],(function(n,l){n(l,1,0)}),null)}),{},{},[]),P=e("IheW"),F=e("ocFP"),x=e("1dSU"),N=e("xgBC"),w=e("QURO"),B=e("ElRG"),_=e("v2G1"),y=e("t8sF"),O=e("s3Gz"),j=e("ZWll"),M=e("Pn9U"),I=e("niFY"),U=e("wMzM"),T=e("AjED"),V=e("Q1xG"),X=e("PCNd");e.d(l,"PinPageModuleNgFactory",(function(){return R}));var R=u.zb(d,[],(function(n){return u.Kb([u.Lb(512,u.m,u.kb,[[8,[h.a,p.a,S]],[3,u.m],u.D]),u.Lb(4608,v.n,v.m,[u.z,[2,v.y]]),u.Lb(4608,i.o,i.o,[]),u.Lb(4608,f.c,f.c,[u.F,u.g]),u.Lb(4608,f.Ib,f.Ib,[f.c,u.m,u.w]),u.Lb(4608,f.Mb,f.Mb,[f.c,u.m,u.w]),u.Lb(4608,P.j,P.p,[v.c,u.I,P.n]),u.Lb(4608,P.q,P.q,[P.j,P.o]),u.Lb(5120,P.a,(function(n){return[n]}),[P.q]),u.Lb(4608,P.m,P.m,[]),u.Lb(6144,P.k,null,[P.m]),u.Lb(4608,P.i,P.i,[P.k]),u.Lb(6144,P.b,null,[P.i]),u.Lb(4608,P.g,P.l,[P.b,u.w]),u.Lb(4608,P.c,P.c,[P.g]),u.Lb(4608,i.c,i.c,[]),u.Lb(4608,o.a,o.a,[f.Rb]),u.Lb(4608,b.a,b.a,[m.n,F.a,o.a]),u.Lb(4608,x.a,x.a,[N.b]),u.Lb(4608,s.a,s.a,[P.c,b.a,x.a]),u.Lb(4608,w.a,w.a,[B.a,f.Lb]),u.Lb(4608,_.a,_.a,[f.b]),u.Lb(4608,y.a,y.a,[]),u.Lb(4608,O.a,O.a,[]),u.Lb(4608,j.a,j.a,[M.a,o.a,r.a]),u.Lb(4608,I.a,I.a,[a.a,P.c,x.a,b.a]),u.Lb(4608,U.a,U.a,[]),u.Lb(4608,T.a,T.a,[b.a,P.c]),u.Lb(1073742336,v.b,v.b,[]),u.Lb(1073742336,i.n,i.n,[]),u.Lb(1073742336,i.g,i.g,[]),u.Lb(1073742336,f.Fb,f.Fb,[]),u.Lb(1073742336,P.e,P.e,[]),u.Lb(1073742336,P.d,P.d,[]),u.Lb(1073742336,i.l,i.l,[]),u.Lb(1073742336,V.a,V.a,[]),u.Lb(1073742336,X.a,X.a,[]),u.Lb(1073742336,m.p,m.p,[[2,m.u],[2,m.n]]),u.Lb(1073742336,d,d,[]),u.Lb(256,P.n,"XSRF-TOKEN",[]),u.Lb(256,P.o,"X-XSRF-TOKEN",[]),u.Lb(1024,m.l,(function(){return[[{path:"",component:c}]]}),[])])}))}}]);