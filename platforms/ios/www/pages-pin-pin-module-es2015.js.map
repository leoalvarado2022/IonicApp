{"version":3,"sources":["./src/app/modules/auth/pages/pin/pin.page.html","./src/app/modules/auth/pages/pin/pin.module.ts","./src/app/modules/auth/pages/pin/pin.page.scss","./src/app/modules/auth/pages/pin/pin.page.ts"],"names":[],"mappings":"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","file":"pages-pin-pin-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button class=\\\"white\\\" text=\\\"\\\"></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n  <div class=\\\"title-header\\\">\\n    <h3 class=\\\"ion-text-left\\\">PIN</h3>\\n  </div>\\n</ion-header>\\n\\n<ion-content>\\n  <div class=\\\"pd-default\\\">\\n    <br>\\n    <form (ngSubmit)=\\\"onSubmit()\\\" [formGroup]=\\\"pinForm\\\">\\n      <ion-item>\\n        <ion-label position=\\\"floating\\\">PIN</ion-label>\\n        <ion-input\\n          formControlName=\\\"pin\\\"\\n          type=\\\"number\\\">\\n        </ion-input>\\n      </ion-item>\\n      <div *ngIf=\\\"pinForm.controls.pin.dirty && pinForm.hasError('required', 'pin')\\\" style=\\\"color: red\\\">\\n        El Pin es requerido\\n      </div>\\n\\n      <br/>\\n      <ion-button\\n        [disabled]=\\\"pinForm.invalid\\\"\\n        color=\\\"danger\\\"\\n        expand=\\\"block\\\"\\n        type=\\\"submit\\\">\\n        Aceptar\\n      </ion-button>\\n    </form>\\n  </div>\\n</ion-content>\\n\"","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {FormsModule} from '@angular/forms';\nimport {RouterModule, Routes} from '@angular/router';\n\nimport {IonicModule} from '@ionic/angular';\n\nimport {PinPage} from './pin.page';\nimport {SharedModule} from '../../../../shared/shared.module';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PinPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [PinPage]\n})\nexport class PinPageModule {\n}\n","export default \"ion-toolbar {\\n  --background: var(--color-login-header);\\n}\\n\\nion-header {\\n  --background: var(--color-login-header);\\n  background: var(--color-login-header);\\n  --color: white;\\n  color: white;\\n}\\n\\nion-header .title-header {\\n  background: var(--color-login-header);\\n}\\n\\nion-header .title-header h3 {\\n  padding-left: 5%;\\n}\\n\\n@media (min-width: 360px) {\\n  ion-header .title-header h3 {\\n    padding-bottom: 10px;\\n    padding-top: 20px;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9sdWlzY29udHJlcmFzL1ByaW1ldGVjL2Z4MTEvZngxMV9tb2JpbGUvc3JjL2FwcC9tb2R1bGVzL2F1dGgvcGFnZXMvcGluL3Bpbi5wYWdlLnNjc3MiLCJzcmMvYXBwL21vZHVsZXMvYXV0aC9wYWdlcy9waW4vcGluLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHVDQUFBO0FDQ0Y7O0FERUE7RUFDRSx1Q0FBQTtFQUNBLHFDQUFBO0VBQ0EsY0FBQTtFQUNBLFlBQUE7QUNDRjs7QURDRTtFQUNFLHFDQUFBO0FDQ0o7O0FEQ0k7RUFDRSxnQkFBQTtBQ0NOOztBREFNO0VBRkY7SUFHSSxvQkFBQTtJQUNBLGlCQUFBO0VDR047QUFDRiIsImZpbGUiOiJzcmMvYXBwL21vZHVsZXMvYXV0aC9wYWdlcy9waW4vcGluLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi10b29sYmFyIHtcbiAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xufVxuXG5pb24taGVhZGVyIHtcbiAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xuICAtLWNvbG9yOiB3aGl0ZTtcbiAgY29sb3I6IHdoaXRlO1xuXG4gIC50aXRsZS1oZWFkZXIge1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWNvbG9yLWxvZ2luLWhlYWRlcik7XG5cbiAgICBoMyB7XG4gICAgICBwYWRkaW5nLWxlZnQ6IDUlO1xuICAgICAgQG1lZGlhIChtaW4td2lkdGg6IDM2MHB4KSB7XG4gICAgICAgIHBhZGRpbmctYm90dG9tOiAxMHB4O1xuICAgICAgICBwYWRkaW5nLXRvcDogMjBweDtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImlvbi10b29sYmFyIHtcbiAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xufVxuXG5pb24taGVhZGVyIHtcbiAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xuICBiYWNrZ3JvdW5kOiB2YXIoLS1jb2xvci1sb2dpbi1oZWFkZXIpO1xuICAtLWNvbG9yOiB3aGl0ZTtcbiAgY29sb3I6IHdoaXRlO1xufVxuaW9uLWhlYWRlciAudGl0bGUtaGVhZGVyIHtcbiAgYmFja2dyb3VuZDogdmFyKC0tY29sb3ItbG9naW4taGVhZGVyKTtcbn1cbmlvbi1oZWFkZXIgLnRpdGxlLWhlYWRlciBoMyB7XG4gIHBhZGRpbmctbGVmdDogNSU7XG59XG5AbWVkaWEgKG1pbi13aWR0aDogMzYwcHgpIHtcbiAgaW9uLWhlYWRlciAudGl0bGUtaGVhZGVyIGgzIHtcbiAgICBwYWRkaW5nLWJvdHRvbTogMTBweDtcbiAgICBwYWRkaW5nLXRvcDogMjBweDtcbiAgfVxufSJdfQ== */\"","import {Component, OnInit} from '@angular/core';\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\nimport {LoaderService} from '../../../../shared/services/loader/loader.service';\nimport {AuthService} from '../../../../shared/services/auth/auth.service';\nimport {Router} from '@angular/router';\nimport {ToastService} from '../../../../shared/services/toast/toast.service';\nimport {UserService} from '../../../../shared/services/user/user.service';\nimport {HttpService} from '../../../../shared/services/http/http.service';\n\n@Component({\n  selector: 'app-pin',\n  templateUrl: './pin.page.html',\n  styleUrls: ['./pin.page.scss'],\n})\nexport class PinPage implements OnInit {\n\n  public pinForm: FormGroup;\n\n  constructor(\n    private formBuilder: FormBuilder,\n    private loaderService: LoaderService,\n    private authService: AuthService,\n    private userService: UserService,\n    private router: Router,\n    private toastService: ToastService,\n    private httpService: HttpService\n  ) {\n\n  }\n\n  ngOnInit() {\n    this.pinForm = this.formBuilder.group({\n      pin: ['', [\n        Validators.required,\n      ]]\n    });\n  }\n\n  /**\n   * onSubmit pin\n   */\n  public onSubmit = async () => {\n    this.loaderService.startLoader();\n    try {\n      const data = Object.assign({}, this.pinForm.value);\n\n      if (data && data.pin) {\n        const connectionPin = await this.createUserConnection(data);\n\n\n        if (connectionPin.data && connectionPin.status === 201) {\n\n          const user: any = await this.userConnection();\n          if (user.user && user.status === 200) {\n\n            const checkToken: any = await this.checkToken();\n            if (checkToken.data && checkToken.status === 200) {\n\n              this.authService.setConnection(checkToken.data[0]);\n\n              console.log(connectionPin, 'connectionPin');\n              console.log(user, 'user');\n              console.log(checkToken, 'checkToken');\n\n              const role = checkToken.data[0].rol;\n              const id_conexion = connectionPin.data[0].id_conexion;\n\n              const data = Object.assign(user.user[0], {\n                names: user.user[0].name,\n                password: '',\n                role,\n                pin: this.pinForm.value.pin,\n                connectionId: id_conexion,\n                app: 'FX10',\n                idUsuario: connectionPin.data[0].id_usuario\n              });\n\n              const response = await this.assignUser(data);\n\n              if (response === null || response.status !== 200) {\n                this.pinForm.get('pin').setValue('');\n                // this.toastService.errorToast( 'El PIN ingresado es inválido.')\n              } else {\n                this.pinForm.reset();\n                await this.userService.removeUserRemember();\n                await this.userService.removeUserData();\n                this.authService.removeToken();\n                this.authService.removeConnection();\n                this.router.navigate(['auth/login']);\n                // this.router.navigate(['/auth'])\n              }\n              //\n            }\n          }\n\n        }\n      }\n\n      this.loaderService.stopLoader();\n\n    } catch (e) {\n      this.loaderService.stopLoader();\n    }\n  }\n\n\n  /**\n   * check token\n   * @param pin\n   */\n  private checkToken = (): Promise<any> => {\n    // this.loaderService.showLoader();\n    return new Promise((resolve) => {\n      this.authService.checkToken().subscribe((success: any) => {\n\n        // this.loaderService.hideLoader();\n        // this.toastService.successToast('Se creo la conexion correctamente, por favor inicie sesión');\n        resolve(success);\n      }, error => {\n        this.httpService.errorHandler(error);\n        resolve(null);\n      });\n    });\n  }\n\n  /**\n   * check token\n   * @param pin\n   */\n  private assignUser = (data: any): Promise<any> => {\n    // this.loaderService.showLoader();\n    return new Promise((resolve) => {\n      this.userService.assignUser(data).subscribe((success: any) => {\n        // this.loaderService.hideLoader();\n        // this.toastService.successToast('Se creo la conexion correctamente, por favor inicie sesión');\n        resolve(success);\n      }, error => {\n        this.httpService.errorHandler(error);\n        resolve(null);\n      });\n    });\n  }\n\n  /**\n   * use connection\n   * @param pin\n   */\n  private userConnection = (): Promise<any> => {\n    // this.loaderService.showLoader();\n    return new Promise((resolve) => {\n      this.userService.getUser().subscribe((success: any) => {\n        // this.loaderService.hideLoader();\n        // this.toastService.successToast('Se creo la conexion correctamente, por favor inicie sesión');\n        resolve(success);\n      }, error => {\n        this.httpService.errorHandler(error);\n        resolve(null);\n      });\n    });\n  }\n\n  /**\n   * createConnectionPin\n   * @param pin\n   */\n  private createUserConnection = (pin: any): Promise<any> => {\n    // this.loaderService.showLoader();\n    return new Promise((resolve) => {\n      this.authService.createPinConnection(pin).subscribe((success: any) => {\n        // this.loaderService.hideLoader();\n        // this.toastService.successToast('Se creo la conexion correctamente, por favor inicie sesión');\n        resolve(success);\n      }, error => {\n        this.httpService.errorHandler(error);\n        resolve(null);\n      });\n    });\n  }\n\n}\n"],"sourceRoot":"webpack:///"}